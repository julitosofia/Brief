{% extends "base.html" %}
{% block title %}Revisión de brief{% endblock %}

{% block content %}
<div class="container" style="max-width: 1000px;">

  <div class="card" style="background-color: var(--color-dark); color: white; margin-bottom: 40px;">
    <p style="text-transform: uppercase; font-weight: 800; font-size: 0.8rem; letter-spacing: 2px; margin-bottom: 10px; color: var(--color-accent);">
      Modo Revisor Data
    </p>
    <h1 style="color: white; margin: 0; font-size: 2.5rem;">{{ proyecto.nombre }}</h1>
  </div>

  <form method="POST">
    {% for brief in briefs %}
      <div class="card" style="margin-bottom: 50px; position: relative;">
        
        <div style="position: absolute; top: -15px; right: 20px;">
            <span class="status-badge 
                {% if brief.estado == 'ok' %}status-aprobado
                {% elif brief.estado == 'observado' %}status-observado
                {% else %}status-default{% endif %}">
                Estado: {{ brief.estado|upper }}
            </span>
        </div>

        <h3 style="font-size: 1.8rem; margin-bottom: 5px;">{{ brief.seccion }}</h3>
        <p style="font-weight: 700; text-transform: uppercase; font-size: 0.75rem; color: #888;">Contenido recibido de Campo:</p>

        <div class="response-box">
          {{ brief.respuesta or "SIN RESPUESTA AÚN" }}
        </div>

        <hr style="border: 0; border-top: 2px solid var(--color-dark); margin: 30px 0;">

        <label style="font-weight: 900; text-transform: uppercase; font-size: 0.9rem;">Tu veredicto para esta sección:</label>
        
        <div class="decision-group">
          <label class="decision-option">
            <input type="radio" name="accion_{{ brief.id }}" value="aprobar">
            ✓ Aprobar
          </label>
          <label class="decision-option">
            <input type="radio" name="accion_{{ brief.id }}" value="observar">
            ⚠ Observar
          </label>
        </div>

        <div class="form-group">
          <label>Comentarios / Instrucciones de corrección</label>
          <textarea 
            name="comentario_{{ brief.id }}" 
            rows="3" 
            placeholder="Si observas la sección, explica qué debe corregirse..."
          ></textarea>
        </div>

        {% if brief.comentarios %}
          <div class="history-box">
            <p style="margin: 0 0 10px 0; font-weight: 800; font-size: 0.7rem; text-transform: uppercase; border-bottom: 1px solid var(--color-dark);">
                Historial de observaciones
            </p>
            {% for c in brief.comentarios %}
              <div class="history-item">
                <p style="margin: 0; font-weight: 600;">"{{ c.comentario }}"</p>
                <small style="text-transform: uppercase; font-weight: 800; color: #888;">— {{ c.autor.nombre }}</small>
              </div>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    {% endfor %}

    <div class="card" style="display: flex; gap: 20px; align-items: center; background: var(--color-accent); position: sticky; bottom: 20px; z-index: 100;">
      <button type="submit" class="btn-primary" style="background: var(--color-dark); color: white;">
        Publicar Revisión Completa
      </button>
      <a href="{{ url_for('data.dashboard') }}" class="btn-cancel" style="color: var(--color-dark);">
        Cancelar cambios
      </a>
    </div>

  </form>
</div>
{% endblock %}



